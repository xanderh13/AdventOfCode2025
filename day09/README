Kinda slow, maybe there's a smarter algorithm...
Or use GEOS API or shapely with Python
